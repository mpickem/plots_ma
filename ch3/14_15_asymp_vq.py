#! /usr/bin/env python

from __future__ import print_function, division, absolute_import
import numpy as np
import matplotlib.pyplot as plt
import h5py
import sys

# make matplot math look like latex
plt.rcParams['mathtext.fontset'] = 'stix'
plt.rcParams['font.family'] = 'STIXGeneral'

vq60g = h5py.File('../Output-SrVO3-readgiw--bugfix--N60-VQ-gamma-new/adga-20171214-121454.127-output.hdf5','r')
vq60 = h5py.File('../Output-SrVO3-readgiw--bugfix--N60-VQ-bugfix/adga-20171202-163625.597-output.hdf5','r')
vq120 = h5py.File('../Output-SrVO3-readgiw--bugfix--N120-VQ-bugfix/adga-20171202-221617.720-output.hdf5','r')
vq200 = h5py.File('../Output-SrVO3-readgiw--bugfix--N200-VQ-bugfix/adga-20180118-081336.185-output.hdf5','r')

beta = 10.0
fmats = np.arange(np.pi/beta, 100, 2*np.pi/beta)

g = plt.figure(figsize=(12,6))
ax1 = g.add_subplot(241)
ax1.set_title(r'$\Gamma = (0,0,0)$', fontsize=14)
ax1.set_ylabel(r'$\mathrm{Im}\Sigma(\mathbf{k},i\nu)$', fontsize=14)
ax1.set_xlabel(r'$i\nu$', fontsize=14)
ax1.set_ylim(-1.0,0.0)
ax1.set_yticks([-1,-0.8,-0.6,-0.4,-0.2,0])
plt.plot(fmats[:120], vq60['input/siw'][0,2000:2120].imag, lw='4', ls='--', c='gray')
plt.plot(fmats[:60], vq60['selfenergy/nonloc/dga'][0,0,0,0,0,60:].imag, label='$N=60$', lw='2')
plt.plot(fmats[:60], vq60g['selfenergy/nonloc/dga'][0,0,0,0,0,60:].imag, label=r'$N=60\;\mathrm{with}\;\gamma^{\omega}$', lw='2')
plt.plot(fmats[:120], vq120['selfenergy/nonloc/dga'][0,0,0,0,0,120:240].imag, label='$N=120$', lw='2')
plt.plot(fmats[:120], vq200['selfenergy/nonloc/dga'][0,0,0,0,0,200:320].imag, label='$N=200$', lw='2')
plt.legend(loc='lower right', frameon=False)


ax1 = g.add_subplot(242)
ax1.set_title(r'$X = (0,\pi,0)$', fontsize=14)
ax1.set_xlabel(r'$i\nu$', fontsize=14)
ax1.set_ylim(-1.0,0.0)
ax1.set_yticks([-1,-0.8,-0.6,-0.4,-0.2,0])
plt.plot(fmats[:120], vq60['input/siw'][0,2000:2120].imag, lw='4', ls='--', c='gray')
plt.plot(fmats[:60], vq60['selfenergy/nonloc/dga'][0,0,0,10,0,60:].imag, lw='2')
plt.plot(fmats[:60], vq60g['selfenergy/nonloc/dga'][0,0,0,10,0,60:].imag, lw='2')
plt.plot(fmats[:120], vq120['selfenergy/nonloc/dga'][0,0,0,10,0,120:240].imag, lw='2')
plt.plot(fmats[:120], vq200['selfenergy/nonloc/dga'][0,0,0,10,0,200:320].imag, lw='2')
plt.legend(frameon=False)

ax1 = g.add_subplot(243)
ax1.set_title(r'$M = (\pi,\pi,0)$', fontsize=14)
ax1.set_xlabel(r'$i\nu$', fontsize=14)
ax1.set_ylim(-1.0,0.0)
ax1.set_yticks([-1,-0.8,-0.6,-0.4,-0.2,0])
plt.plot(fmats[:120], vq60['input/siw'][0,2000:2120].imag, lw='4', ls='--', c='gray')
plt.plot(fmats[:60], vq60['selfenergy/nonloc/dga'][0,0,10,10,0,60:].imag, lw='2')
plt.plot(fmats[:60], vq60g['selfenergy/nonloc/dga'][0,0,10,10,0,60:].imag, lw='2')
plt.plot(fmats[:120], vq120['selfenergy/nonloc/dga'][0,0,10,10,0,120:240].imag, lw='2')
plt.plot(fmats[:120], vq200['selfenergy/nonloc/dga'][0,0,10,10,0,200:320].imag, lw='2')
plt.legend(frameon=False)

ax1 = g.add_subplot(244)
ax1.set_title(r'$R = (\pi,\pi,\pi)$', fontsize=14)
ax1.set_xlabel(r'$i\nu$', fontsize=14)
ax1.set_ylim(-1.0,0.0)
ax1.set_yticks([-1,-0.8,-0.6,-0.4,-0.2,0])
plt.plot(fmats[:120], vq60['input/siw'][0,2000:2120].imag, lw='4', ls='--', c='gray')
plt.plot(fmats[:60], vq60['selfenergy/nonloc/dga'][0,0,10,10,10,60:].imag, lw='2')
plt.plot(fmats[:60], vq60g['selfenergy/nonloc/dga'][0,0,10,10,10,60:].imag, lw='2')
plt.plot(fmats[:120], vq120['selfenergy/nonloc/dga'][0,0,10,10,10,120:240].imag, lw='2')
plt.plot(fmats[:120], vq200['selfenergy/nonloc/dga'][0,0,10,10,10,200:320].imag, lw='2')
plt.legend(frameon=False)

ax1 = g.add_subplot(245)
ax1.set_ylabel(r'$\mathrm{Im}\Sigma(\mathbf{k},i\nu)$')
ax1.set_xlabel(r'$i\nu$', fontsize=14)
ax1.set_ylim(-1,-0.4)
ax1.set_yticks([-1,-0.8,-0.6,-0.4])
plt.plot(fmats[:10], vq60['input/siw'][0,2000:2010].imag, lw='4', ls='--', c='gray')
plt.plot(fmats[:10], vq60['selfenergy/nonloc/dga'][0,0,0,0,0,60:70].imag, lw='2')
plt.plot(fmats[:10], vq60g['selfenergy/nonloc/dga'][0,0,0,0,0,60:70].imag, lw='2')
plt.plot(fmats[:10], vq120['selfenergy/nonloc/dga'][0,0,0,0,0,120:130].imag, lw='2')
plt.plot(fmats[:10], vq200['selfenergy/nonloc/dga'][0,0,0,0,0,200:210].imag, lw='2')
plt.legend(frameon=False)

ax1 = g.add_subplot(246)
ax1.set_xlabel(r'$i\nu$', fontsize=14)
ax1.set_ylim(-1,-0.4)
ax1.set_yticks([-1,-0.8,-0.6,-0.4])
plt.plot(fmats[:10], vq60['input/siw'][0,2000:2010].imag, lw='4', ls='--', c='gray')
plt.plot(fmats[:10], vq60['selfenergy/nonloc/dga'][0,0,0,10,0,60:70].imag, lw='2')
plt.plot(fmats[:10], vq60g['selfenergy/nonloc/dga'][0,0,0,10,0,60:70].imag, lw='2')
plt.plot(fmats[:10], vq120['selfenergy/nonloc/dga'][0,0,0,10,0,120:130].imag, lw='2')
plt.plot(fmats[:10], vq200['selfenergy/nonloc/dga'][0,0,0,10,0,200:210].imag, lw='2')
plt.legend(frameon=False)

ax1 = g.add_subplot(247)
ax1.set_xlabel(r'$i\nu$', fontsize=14)
ax1.set_ylim(-1,-0.4)
ax1.set_yticks([-1,-0.8,-0.6,-0.4])
plt.plot(fmats[:10], vq60['input/siw'][0,2000:2010].imag, lw='4', ls='--', c='gray')
plt.plot(fmats[:10], vq60['selfenergy/nonloc/dga'][0,0,10,10,0,60:70].imag, lw='2')
plt.plot(fmats[:10], vq60g['selfenergy/nonloc/dga'][0,0,10,10,0,60:70].imag, lw='2')
plt.plot(fmats[:10], vq120['selfenergy/nonloc/dga'][0,0,10,10,0,120:130].imag, lw='2')
plt.plot(fmats[:10], vq200['selfenergy/nonloc/dga'][0,0,10,10,0,200:210].imag, lw='2')
plt.legend(frameon=False)

ax1 = g.add_subplot(248)
ax1.set_xlabel(r'$i\nu$', fontsize=14)
ax1.set_ylim(-1,-0.4)
ax1.set_yticks([-1,-0.8,-0.6,-0.4])
plt.plot(fmats[:10], vq60['input/siw'][0,2000:2010].imag, lw='4', ls='--', c='gray')
plt.plot(fmats[:10], vq60['selfenergy/nonloc/dga'][0,0,10,10,10,60:70].imag, lw='2')
plt.plot(fmats[:10], vq60g['selfenergy/nonloc/dga'][0,0,10,10,10,60:70].imag, lw='2')
plt.plot(fmats[:10], vq120['selfenergy/nonloc/dga'][0,0,10,10,10,120:130].imag, lw='2')
plt.plot(fmats[:10], vq200['selfenergy/nonloc/dga'][0,0,10,10,10,200:210].imag, lw='2')
plt.legend(frameon=False)

plt.tight_layout()
plt.savefig('2x4_asymp_hf_imag.eps', bbox_inches='tight', format='eps', dpi=600, rasterized=True)

plt.show()


h = plt.figure(figsize=(12,6))
ax1 = h.add_subplot(241)
ax1.set_title(r'$\Gamma = (0,0,0)$', fontsize=14)
ax1.set_ylabel(r'$\mathrm{Re}\Sigma(\mathbf{k},i\nu)$', fontsize=14)
ax1.set_xlabel(r'$i\nu$', fontsize=14)
ax1.set_ylim(1.8,3)
ax1.set_yticks([1.8,2.1,2.4,2.7,3.0])
plt.plot(fmats[:120], vq60['input/siw'][0,2000:2120].real, lw='4', ls='--', c='gray')
plt.plot(fmats[:60], vq60['selfenergy/nonloc/dga'][0,0,0,0,0,60:].real, label='$N=60$', lw='2')
plt.plot(fmats[:60], vq60g['selfenergy/nonloc/dga'][0,0,0,0,0,60:].real, label=r'$N=60\;\mathrm{with}\;\gamma^{\omega}$', lw='2')
plt.plot(fmats[:120], vq120['selfenergy/nonloc/dga'][0,0,0,0,0,120:240].real, label='$N=120$', lw='2')
plt.plot(fmats[:120], vq200['selfenergy/nonloc/dga'][0,0,0,0,0,200:320].real, label='$N=200$', lw='2')
plt.legend(loc='lower right', frameon=False)


ax1 = h.add_subplot(242)
ax1.set_title(r'$X = (0,\pi,0)$', fontsize=14)
ax1.set_xlabel(r'$i\nu$', fontsize=14)
ax1.set_ylim(1.8,3)
ax1.set_yticks([1.8,2.1,2.4,2.7,3.0])
plt.plot(fmats[:120], vq60['input/siw'][0,2000:2120].real, lw='4', ls='--', c='gray')
plt.plot(fmats[:60], vq60['selfenergy/nonloc/dga'][0,0,0,10,0,60:].real, lw='2')
plt.plot(fmats[:60], vq60g['selfenergy/nonloc/dga'][0,0,0,10,0,60:].real, lw='2')
plt.plot(fmats[:120], vq120['selfenergy/nonloc/dga'][0,0,0,10,0,120:240].real, lw='2')
plt.plot(fmats[:120], vq200['selfenergy/nonloc/dga'][0,0,0,10,0,200:320].real, lw='2')
plt.legend(frameon=False)

ax1 = h.add_subplot(243)
ax1.set_title(r'$M = (\pi,\pi,0)$', fontsize=14)
ax1.set_xlabel(r'$i\nu$', fontsize=14)
ax1.set_ylim(1.8,3)
ax1.set_yticks([1.8,2.1,2.4,2.7,3.0])
plt.plot(fmats[:120], vq60['input/siw'][0,2000:2120].real, lw='4', ls='--', c='gray')
plt.plot(fmats[:60], vq60['selfenergy/nonloc/dga'][0,0,10,10,0,60:].real, lw='2')
plt.plot(fmats[:60], vq60g['selfenergy/nonloc/dga'][0,0,10,10,0,60:].real, lw='2')
plt.plot(fmats[:120], vq120['selfenergy/nonloc/dga'][0,0,10,10,0,120:240].real, lw='2')
plt.plot(fmats[:120], vq200['selfenergy/nonloc/dga'][0,0,10,10,0,200:320].real, lw='2')
plt.legend(frameon=False)

ax1 = h.add_subplot(244)
ax1.set_title(r'$R = (\pi,\pi,\pi)$', fontsize=14)
ax1.set_xlabel(r'$i\nu$', fontsize=14)
ax1.set_ylim(1.8,3)
ax1.set_yticks([1.8,2.1,2.4,2.7,3.0])
plt.plot(fmats[:120], vq60['input/siw'][0,2000:2120].real, lw='4', ls='--', c='gray')
plt.plot(fmats[:60], vq60['selfenergy/nonloc/dga'][0,0,10,10,10,60:].real, lw='2')
plt.plot(fmats[:60], vq60g['selfenergy/nonloc/dga'][0,0,10,10,10,60:].real, lw='2')
plt.plot(fmats[:120], vq120['selfenergy/nonloc/dga'][0,0,10,10,10,120:240].real, lw='2')
plt.plot(fmats[:120], vq200['selfenergy/nonloc/dga'][0,0,10,10,10,200:320].real, lw='2')
plt.legend(frameon=False)

ax1 = h.add_subplot(245)
ax1.set_ylabel(r'$\mathrm{Re}\Sigma(\mathbf{k},i\nu)$')
ax1.set_xlabel(r'$i\nu$', fontsize=14)
ax1.set_ylim(1.8,3)
ax1.set_yticks([1.8,2.1,2.4,2.7,3.0])
plt.plot(fmats[:10], vq60['input/siw'][0,2000:2010].real, lw='4', ls='--', c='gray')
plt.plot(fmats[:10], vq60['selfenergy/nonloc/dga'][0,0,0,0,0,60:70].real, lw='2')
plt.plot(fmats[:10], vq60g['selfenergy/nonloc/dga'][0,0,0,0,0,60:70].real, lw='2')
plt.plot(fmats[:10], vq120['selfenergy/nonloc/dga'][0,0,0,0,0,120:130].real, lw='2')
plt.plot(fmats[:10], vq200['selfenergy/nonloc/dga'][0,0,0,0,0,200:210].real, lw='2')
plt.legend(frameon=False)

ax1 = h.add_subplot(246)
ax1.set_xlabel(r'$i\nu$', fontsize=14)
ax1.set_ylim(1.8,3)
ax1.set_yticks([1.8,2.1,2.4,2.7,3.0])
plt.plot(fmats[:10], vq60['input/siw'][0,2000:2010].real, lw='4', ls='--', c='gray')
plt.plot(fmats[:10], vq60['selfenergy/nonloc/dga'][0,0,0,10,0,60:70].real, lw='2')
plt.plot(fmats[:10], vq60g['selfenergy/nonloc/dga'][0,0,0,10,0,60:70].real, lw='2')
plt.plot(fmats[:10], vq120['selfenergy/nonloc/dga'][0,0,0,10,0,120:130].real, lw='2')
plt.plot(fmats[:10], vq200['selfenergy/nonloc/dga'][0,0,0,10,0,200:210].real, lw='2')
plt.legend(frameon=False)

ax1 = h.add_subplot(247)
ax1.set_xlabel(r'$i\nu$', fontsize=14)
ax1.set_ylim(1.8,3)
ax1.set_yticks([1.8,2.1,2.4,2.7,3.0])
plt.plot(fmats[:10], vq60['input/siw'][0,2000:2010].real, lw='4', ls='--', c='gray')
plt.plot(fmats[:10], vq60['selfenergy/nonloc/dga'][0,0,10,10,0,60:70].real, lw='2')
plt.plot(fmats[:10], vq60g['selfenergy/nonloc/dga'][0,0,10,10,0,60:70].real, lw='2')
plt.plot(fmats[:10], vq120['selfenergy/nonloc/dga'][0,0,10,10,0,120:130].real, lw='2')
plt.plot(fmats[:10], vq200['selfenergy/nonloc/dga'][0,0,10,10,0,200:210].real, lw='2')
plt.legend(frameon=False)

ax1 = h.add_subplot(248)
ax1.set_xlabel(r'$i\nu$', fontsize=14)
ax1.set_ylim(1.8,3)
ax1.set_yticks([1.8,2.1,2.4,2.7,3.0])
plt.plot(fmats[:10], vq60['input/siw'][0,2000:2010].real, lw='4', ls='--', c='gray')
plt.plot(fmats[:10], vq60['selfenergy/nonloc/dga'][0,0,10,10,10,60:70].real, lw='2')
plt.plot(fmats[:10], vq60g['selfenergy/nonloc/dga'][0,0,10,10,10,60:70].real, lw='2')
plt.plot(fmats[:10], vq120['selfenergy/nonloc/dga'][0,0,10,10,10,120:130].real, lw='2')
plt.plot(fmats[:10], vq200['selfenergy/nonloc/dga'][0,0,10,10,10,200:210].real, lw='2')
plt.legend(frameon=False)

plt.tight_layout()
plt.savefig('2x4_asymp_hf_real.eps', bbox_inches='tight', format='eps', dpi=600, rasterized=True)

plt.show()
